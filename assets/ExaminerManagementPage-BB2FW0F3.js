import{Y as H,j as e,b3 as m,bB as B,r,p as I,G as l,bC as C,aV as F,bD as E,bE as q,s as R,bF as O,u as G,bG as L,bp as K,bH as $,bI as W,f as Q,I as D,bJ as U,bK as z,bL as Y}from"./index-DXjriJ5e.js";import{P as J,D as X}from"./DashboardCard-W43j5QG8.js";import{b as Z,i as ee,c as te}from"./adminApi-83yZrLKr.js";import{r as ne,e as ae}from"./Status-GYzEMVEP.js";import{c as se,a as y,b as oe,o as re}from"./object-vZIloyjJ.js";import{a as ie,b as le,c as ce,R as de}from"./Regex-ISovgeUC.js";import"./Box-B6HrpxK0.js";const he=H(e.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8m0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4z"}),"Loop");function me({show:s,setShow:d,title:b,callBack:p,status:x}){const u=()=>d(!1),f=()=>{u(),p()};return e.jsx(e.Fragment,{children:e.jsxs(m,{show:s,onHide:u,backdrop:"static",keyboard:!1,children:[e.jsx(m.Header,{closeButton:!0,children:e.jsx(m.Title,{children:`${x==="Active"?"Khóa":"Mở khóa"} ${b}`})}),e.jsx(m.Body,{children:`Bạn có chắc chắn muốn ${x==="Active"?"khóa":"mở khóa"} ${b} này?`}),e.jsxs(m.Footer,{children:[e.jsx(B,{variant:"secondary",size:"lg",onClick:u,children:"Không"}),e.jsx(B,{variant:"danger",size:"lg",onClick:()=>f(),children:"Có"})]})]})})}const ue="_btnCreate_1vzyn_1",pe="_buttonContainer_1vzyn_16",ge="_title_1vzyn_82",be="_titleHeader_1vzyn_89",xe="_modalForm_1vzyn_95",ye="_inputModal_1vzyn_113",fe="_btnAdd_1vzyn_117",je="_formControl_1vzyn_131",ke="_error_1vzyn_135",c={btnCreate:ue,buttonContainer:pe,title:ge,titleHeader:be,modalForm:xe,inputModal:ye,btnAdd:fe,formControl:je,error:ke,"react-datepicker__input-container":"_react-datepicker__input-container_1vzyn_140"},Ce=r.forwardRef(({modalShow:s,toggle:d},b)=>{var N,w,_,t,o,a;const[p,x]=r.useState(new Date),u=[{value:"0",label:"Nam"},{value:"1",label:"Nữ"}];r.useImperativeHandle(b,()=>({handleOpen:()=>{d()}}));const f=se().shape({fullName:y().required("Vui lòng nhập họ tên"),username:y().required("Vui lòng nhập username"),email:y().matches(ie,"Email không hợp lệ").required("Vui lòng nhập email của bạn"),phone:y().matches(le,"Số điện thoại không hợp lệ").required("Vui lòng nhập số điện thoại của bạn"),password:y().required("Vui lòng nhập mật khẩu của bạn").matches(ce,"Mật khẩu của bạn phải chứa 8 ký tự, bao gồm một chữ hoa, một chữ thường, một chữ số và một ký tự đặc biệt."),gender:oe().required("Vui lòng chọn giới tính").typeError("Vui lòng chọn giới tính"),birthday:y().required("Vui lòng chọn ngày sinh").typeError("Vui lòng chọn ngày sinh")}),{control:h,formState:{errors:n},reset:A,handleSubmit:S,setValue:j,trigger:v}=I({resolver:re(f)}),M=async i=>{if(!await v())return;const P=new Date(i.birthday).toISOString(),V={...i,birthday:P,address:"N/A",role:R.STAFF};await O(V)},T=i=>{(i.key==="e"||i.key==="-"||i.key==="+"||i.key==="E"||i.key===".")&&i.preventDefault()},k=r.useCallback(i=>{j("birthday",i,{shouldDirty:!0}),x(i)},[j]);return e.jsx(e.Fragment,{children:e.jsxs(m,{show:s,onHide:d,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[e.jsx(m.Header,{closeButton:!0,style:{margin:"0 auto"},children:e.jsx(m.Title,{id:"contained-modal-title-vcenter",style:{fontWeight:"bold",fontSize:"22px",margin:0,padding:0},children:"Tạo tài khoản của staff"})}),e.jsx(m.Body,{style:{height:"54vh",overflow:"hidden"},children:e.jsxs("form",{onSubmit:S(M),className:c.modalForm,children:[e.jsxs(l,{container:!0,spacing:2,children:[e.jsxs(l,{item:!0,md:6,children:[e.jsx("h4",{className:c.title,children:"Họ và tên"}),e.jsx(C,{control:h,id:"fullName",name:"fullName",error:(N=n==null?void 0:n.fullName)==null?void 0:N.message,"aria-required":"true",type:"text",placeholder:"Nhập họ và tên"})]}),e.jsxs(l,{item:!0,md:6,children:[e.jsx("h4",{className:c.title,children:"Email"}),e.jsx(C,{control:h,error:(w=n==null?void 0:n.email)==null?void 0:w.message,id:"email",name:"email","aria-required":"true",type:"email",placeholder:"Nhập email"})]})]}),e.jsxs(l,{container:!0,spacing:2,children:[e.jsxs(l,{item:!0,md:4,children:[e.jsx("h4",{className:c.title,children:"Số điện thoại"}),e.jsx(C,{control:h,id:"phone",name:"phone",error:(_=n==null?void 0:n.phone)==null?void 0:_.message,"aria-required":"true",type:"number",placeholder:"Nhập số điện thoại",onKeyDown:T})]}),e.jsxs(l,{sx:{height:"0%"},item:!0,md:4,children:[e.jsx("h4",{className:c.title,children:"Ngày sinh"}),e.jsx(F,{name:"birthday",control:h,render:()=>e.jsx(E,{selected:p,dateFormat:"dd/MM/yyyy",placeholderText:"Chọn ngày sinh",maxDate:p,onChange:k})})]}),e.jsxs(l,{item:!0,md:4,children:[e.jsx("h4",{className:c.title,children:"Giới tính"}),e.jsx(de,{control:h,error:(t=n==null?void 0:n.gender)==null?void 0:t.message,defaultValue:!1,name:"gender",valueArray:u})]})]}),e.jsx(l,{container:!0,spacing:2,children:e.jsxs(l,{item:!0,md:12,children:[e.jsx("h4",{className:c.title,children:"Username"}),e.jsx(C,{control:h,id:"username",name:"username",error:(o=n==null?void 0:n.username)==null?void 0:o.message,"aria-required":"true",type:"text",placeholder:"Nhập tên đăng nhập"})]})}),e.jsx(l,{container:!0,spacing:2,children:e.jsxs(l,{item:!0,md:12,children:[e.jsx("h4",{className:c.title,children:"Mật khẩu"}),e.jsx(C,{control:h,id:"password",error:(a=n.password)==null?void 0:a.message,name:"password","aria-required":"true",type:"password",placeholder:"Nhập mật khẩu"})]})}),e.jsx("div",{style:{textAlign:"end"},children:e.jsx(q,{type:"submit",className:c.btnAdd,size:"large",loadingPosition:"center",variant:"contained",children:e.jsx("span",{style:{fontWeight:"bold",fontSize:"14px"},children:"Thêm"})})})]})})]})})}),g=(s,d=20)=>e.jsx(Y,{title:s,children:e.jsx("span",{children:s&&s.length>d?s.substring(0,d)+"...":s})}),Ne=()=>W({typography:{fontSize:20},palette:{background:{default:"#0f172a"},mode:"light"},components:{MuiTableCell:{styleOverrides:{head:{padding:"10px 10px",fontWeight:"bold",borderBottom:"1px solid black"},body:{color:"#000",fontWeight:"bold",borderBottom:"1px solid black"}}}}}),De=()=>{const{userInfo:s}=G(t=>t.auth),[d,b]=r.useState([]),[p,x]=r.useState(null),[u,f]=r.useState(""),[h,n]=r.useState(!1),[A,S]=r.useState(!1),j=r.useRef(null);r.useEffect(()=>{k()},[]);const v=t=>{const o=d.find(a=>a.id===t).status;f(o),x(t),n(!0)},M={searchPlaceholder:"Tìm kiếm theo họ và tên, email, số điện thoại",selectableRows:"none",elevation:5,rowsPerPage:4,rowsPerPageOptions:[4,10,20,30],responsive:"standard",print:!1,download:!1,filter:!1,textLabels:{body:{noMatch:"Không có dữ liệu"},pagination:{rowsPerPage:"Số hàng mỗi trang:",displayRows:"của"},toolbar:{search:"Tìm kiếm",viewColumns:"Xem cột",filterTable:"Lọc bảng"}},onRowClick:(t,o)=>{}},T=[{name:"fullName",label:"HỌ VÀ TÊN",options:{customBodyRender:t=>g(t,30)}},{name:"email",label:"EMAIL",options:{customBodyRender:t=>g(t,20)}},{name:"phone",label:"SỐ ĐIỆN THOẠI",textAlign:"left",options:{customBodyRender:t=>g(t)}},{name:"birthday",label:"NGÀY SINH",options:{customBodyRender:t=>g(Q(t))}},{name:"gender",label:"GIỚI TÍNH",options:{customBodyRender:t=>g(t?"Nữ":"Nam")}},{name:"role",label:"VAI TRÒ",options:{customBodyRender:t=>{const o=ne[t]||t;return g(o)}}},{name:"status",label:"TRẠNG THÁI",options:{customBodyRender:t=>{const o=ae[t]||t;return g(o)}}},{name:"id",label:"TƯƠNG TÁC",options:{customBodyRender:(t,o)=>e.jsxs("span",{children:[e.jsx("span",{style:{display:"none"},name:"id",children:t}),s&&(s==null?void 0:s.role)===R.ADMIN&&e.jsx(D,{"aria-label":"delete",size:"small",color:"error",onClick:a=>{a.stopPropagation(),v(t)},children:e.jsx(he,{})}),e.jsx(D,{"aria-label":"delete",size:"small",color:"info",children:e.jsx(U,{})})]})}}],k=async()=>{try{const{data:t}=await Z(),o=t==null?void 0:t.result.map(a=>({id:a.id,username:a.username,birthday:a.birthday,fullName:a.fullName,email:a.email,address:a.address,phone:a.phone,gender:a.gender,role:a.role,status:a.status}));b(o)}catch(t){console.log(t)}},N=async()=>{try{if(u==="Active"){const{data:t}=await ee(p);t!=null&&t.result&&(z.success("Khóa tài khoản thành công",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),k())}else{const{data:t}=await te(p);t!=null&&t.result&&(z.success("Mở khóa tài khoản thành công",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),k())}}catch(t){console.log("err",t)}},w=r.useCallback(()=>{S(t=>!t)},[]),_=r.useCallback(()=>{var t;(t=j.current)==null||t.handleOpen()},[]);return e.jsxs(J,{title:"Quản lý giám khảo",description:"Quản lý giám khảo",children:[e.jsxs(X,{title:"Quản lý giám khảo",action:e.jsx("div",{className:c.buttonContainer,children:e.jsx("button",{className:c.btnCreate,onClick:_,children:e.jsx("span",{children:"Tạo tài khoản cho Staff"})})}),children:[e.jsx(L,{injectFirst:!0,children:e.jsx(K,{theme:Ne(),children:e.jsx("span",{className:"table-contest table-contest-detail",children:e.jsx($,{data:d,columns:T,options:M})})})}),e.jsx(me,{show:h,setShow:n,title:"tài khoản",callBack:N,status:u})]}),e.jsx(Ce,{ref:j,modalShow:A,toggle:w})]})};export{De as default};
