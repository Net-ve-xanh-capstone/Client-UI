var K=(i,e,n)=>{if(!e.has(i))throw TypeError("Cannot "+n)};var l=(i,e,n)=>(K(i,e,"read from private field"),n?n.call(i):e.get(i)),S=(i,e,n)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,n)},T=(i,e,n,r)=>(K(i,e,"write to private field"),r?r.call(i,n):e.set(i,n),n);var I=(i,e,n)=>(K(i,e,"access private method"),n);import{aU as Is,aV as Es,aW as X,aX as Ms,aY as is,aZ as rs,r as c,a_ as Os,a$ as ks,o as Y,n as ls,b0 as Ls,u as cs,j as s,b1 as L,L as R,T as As,_ as Z,a as Ds,f as Ps,G as _s,b as E,e as Fs}from"./index-BSFiArO3.js";import{H as Vs}from"./HeaderVersion1-Bp-Rq0v_.js";import{A as Hs}from"./index-fp886yEo.js";import{T as Rs,a as Bs,b as z,c as J}from"./TabPanel-BBx3WEQQ.js";/* empty css                   */import{D as k}from"./index-mZIAjqOC.js";import{a as Us}from"./TextareaCommon-BWwa53fZ.js";import{c as ss,a as es,o as ts}from"./object-BNIuJu7P.js";import{b as qs}from"./Status-Nhevn1i3.js";var f,C,x,N,M,H,A,$,ns,Ks=(ns=class extends Is{constructor(e,n){super();S(this,M);S(this,A);S(this,f,void 0);S(this,C,void 0);S(this,x,void 0);S(this,N,void 0);T(this,f,e),this.setOptions(n),this.bindMethods(),I(this,M,H).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var r;const n=this.options;this.options=l(this,f).defaultMutationOptions(e),Es(this.options,n)||l(this,f).getMutationCache().notify({type:"observerOptionsUpdated",mutation:l(this,x),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&X(n.mutationKey)!==X(this.options.mutationKey)?this.reset():((r=l(this,x))==null?void 0:r.state.status)==="pending"&&l(this,x).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=l(this,x))==null||e.removeObserver(this)}onMutationUpdate(e){I(this,M,H).call(this),I(this,A,$).call(this,e)}getCurrentResult(){return l(this,C)}reset(){var e;(e=l(this,x))==null||e.removeObserver(this),T(this,x,void 0),I(this,M,H).call(this),I(this,A,$).call(this)}mutate(e,n){var r;return T(this,N,n),(r=l(this,x))==null||r.removeObserver(this),T(this,x,l(this,f).getMutationCache().build(l(this,f),this.options)),l(this,x).addObserver(this),l(this,x).execute(e)}},f=new WeakMap,C=new WeakMap,x=new WeakMap,N=new WeakMap,M=new WeakSet,H=function(){var n;const e=((n=l(this,x))==null?void 0:n.state)??Ms();T(this,C,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},A=new WeakSet,$=function(e){is.batch(()=>{var n,r,d,p,u,m,b,g;if(l(this,N)&&this.hasListeners()){const h=l(this,C).variables,j=l(this,C).context;(e==null?void 0:e.type)==="success"?((r=(n=l(this,N)).onSuccess)==null||r.call(n,e.data,h,j),(p=(d=l(this,N)).onSettled)==null||p.call(d,e.data,null,h,j)):(e==null?void 0:e.type)==="error"&&((m=(u=l(this,N)).onError)==null||m.call(u,e.error,h,j),(g=(b=l(this,N)).onSettled)==null||g.call(b,void 0,e.error,h,j))}this.listeners.forEach(h=>{h(l(this,C))})})},ns);function $s(i,e){const n=rs(),[r]=c.useState(()=>new Ks(n,i));c.useEffect(()=>{r.setOptions(i)},[r,i]);const d=c.useSyncExternalStore(c.useCallback(u=>r.subscribe(is.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),p=c.useCallback((u,m)=>{r.mutate(u,m).catch(Os)},[r]);if(d.error&&ks(r.options.throwOnError,[d.error]))throw d.error;return{...d,mutate:p,mutateAsync:d.mutate}}const as="collections/getcollectionbyaccountid",Gs="collections",Ws="paintingcollections/addpaintingtocollection",Qs=i=>{var Q;const e=ss().shape({collection:es().required("Vui lòng chọn bộ sưu tập")}),n=ss().shape({name:es().required("Vui lòng nhập tên của bộ sưu tập")}),{watch:r,formState:{errors:d},setValue:p,setError:u,reset:m,handleSubmit:b}=Y({resolver:ts(e),reValidateMode:"onChange"}),{formState:{errors:g},setError:h,control:j,reset:w,handleSubmit:O}=Y({resolver:ts(n),reValidateMode:"onChange"}),[D,t]=c.useState(0),[v,os]=c.useState([]),[B,P]=c.useState([]),[ds,se]=c.useState(!1),[hs,us]=c.useState(""),[_,F]=c.useState(""),[xs,U]=c.useState(""),ms=rs(),q=ls(a=>a.auth.userInfo),G=i.paintingId,ps=(a,o="")=>r(a)||o,js=(a,o)=>{p(a,o.name),us(o.id),u(a,"")},W=(a,o,y)=>$s({mutationFn:a,onSuccess:()=>{ms.invalidateQueries([as,q.Id]),F(o)},onError:()=>{F(y)}}),bs=W(a=>Z.create(Gs,a),"Tạo bộ sưu tập thành công","Tạo bộ sưu tập thất bại"),gs=W(a=>Z.create(Ws,a),"Thêm vào bộ sưu tập thành công","Thêm vào bộ sưu tập thất bại"),vs=a=>{const o={name:a.name,description:a.description,currentUserId:q.Id,listPaintingId:[G]};bs.mutate(o)},Ns=()=>{const a={collectionId:hs,paintingId:G};gs.mutate(a)},fs=async a=>{if(!v)return;const o=v.filter(y=>y.name.toLowerCase().includes(a.toLowerCase()));P(o)},Cs=c.useCallback(Ls.debounce(a=>fs(a),500),[v]),ys=a=>{const o=a.target.value;U(o),Cs(o)},Ss=()=>{i.onHide(),m(),w(),F(""),U(""),P(v)},ws=a=>{t(a),F(""),U(""),h("name",""),u("collection",""),P(v)},{isLoading:Ts,isError:ee,data:V,error:te}=cs(as,q.Id);return c.useEffect(()=>{var o,y;const a=(o=V==null?void 0:V.data)==null?void 0:o.result;((y=a==null?void 0:a.list)==null?void 0:y.length)>0?(t(0),os(a==null?void 0:a.list),P(a==null?void 0:a.list)):t(1)},[V,ds]),Ts?s.jsx("div",{children:"Loading"}):s.jsxs(L,{animation:!0,scrollable:!0,show:i.show,onHide:Ss,children:[s.jsx(L.Header,{closeButton:!0}),s.jsx("div",{className:"modal-body space-y-20 pd-40",style:{height:"500px"},children:s.jsx("div",{className:"flat-tabs themesflat-tabs",children:s.jsxs(Rs,{defaultIndex:D,onSelect:ws,children:[s.jsxs(Bs,{children:[s.jsx(z,{children:"Đã có bộ sưu tập"}),s.jsx(z,{children:"Chưa có bộ sưu tập"})]}),s.jsxs(J,{className:"mt-5",selected:!0,allowFullScreen:!0,children:[s.jsx("div",{id:"item-create",className:"dropdown mt-5",children:B&&B.length>0?s.jsxs("div",{children:[s.jsx("h3",{className:"mb-5",children:"Thêm vào bộ sưu tập"}),d.collection&&s.jsx("span",{className:"text-danger h5",children:d.collection.message}),s.jsxs(k,{children:[s.jsx(k.Select,{placeholder:ps("collection","Chọn collection của bạn")}),s.jsxs(k.List,{children:[s.jsx(k.Search,{defaultValue:xs,onChange:ys}),B.map((a,o)=>s.jsx(k.Option,{onClick:()=>js("collection",a),children:a==null?void 0:a.name},o))]})]}),s.jsx(R,{to:"#",onClick:b(Ns),className:"btn btn-primary mt-4","data-toggle":"modal","data-target":"#popup_bid_success","data-dismiss":"modal","aria-label":"Close",children:"Thêm"}),_&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("p",{style:{color:"#000000",fontWeight:"bold"},children:_})})]}):s.jsxs("div",{children:[s.jsx("h3",{children:"Bạn chưa có bộ sưu tập nào"}),s.jsx("div",{id:"item-create",className:"dropdown mt-5",children:s.jsx("h4",{className:"text-center",children:"Hãy tạo bộ sưu tập mới"})})]})}),s.jsx("div",{className:"hr"})]}),s.jsxs(J,{className:"mt-5",allowFullScreen:!0,children:[s.jsx("h3",{className:"mb-15",children:"Tạo bộ sưu tập mới"}),s.jsx(As,{control:j,error:(Q=g.name)==null?void 0:Q.message,id:"name",name:"name",tabIndex:"1",placeholder:"Nhập tên của bộ sưu tập",className:"mb-15",autoFocus:!0}),s.jsx("div",{className:"hr"}),s.jsx(Us,{control:j,id:"description",name:"description",tabIndex:"1",placeholder:"Nhập mô tả của bức tranh",className:"mb-15",autoFocus:!0}),s.jsx(R,{to:"#",className:"btn btn-primary mt-4","data-toggle":"modal","data-target":"#popup_bid_success","data-dismiss":"modal",onClick:O(vs),"aria-label":"Close",children:"Thêm và tạo bộ sưu tập mới"}),_&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("p",{style:{color:"#000000",fontWeight:"bold"},children:_})})]})]})})})]})},Xs=i=>{const e=i.data,n=i.loading,[r,d]=c.useState(6),[p,u]=c.useState(!1),[m,b]=c.useState(!1),[g,h]=c.useState(null),j=Ds(),w=()=>{d(t=>t+6)},O=t=>{h(t),u(!0)},D=(t,v)=>{qs.includes(t)?j(`/submit/${v}`):b(!0)};return s.jsx(c.Fragment,{children:n?s.jsx(Ys,{}):s.jsxs("div",{children:[s.jsxs("div",{className:"explore",children:[s.jsx("div",{className:"box-epxlore justify-content-start",children:e.length>0?e.slice(0,r).map((t,v)=>s.jsxs("div",{className:`sc-card-product mr-4 explode style2 mg-bt ${t.feature?"comingsoon":""} `,children:[s.jsxs("div",{className:"card-media",children:[s.jsx("div",{children:s.jsx("img",{className:"img-painting object-fit-contain",style:{height:"320px"},src:t==null?void 0:t.image,alt:"tranh"})}),s.jsxs("div",{className:"button-place-bid",children:[s.jsx("button",{onClick:()=>O(t.id),className:"sc-button style-place-bid style fl-button pri-3",style:{width:"220px"},children:s.jsx("span",{children:"Thêm vào bộ sưu tập"})}),s.jsx("button",{onClick:()=>D(t==null?void 0:t.status,t==null?void 0:t.contestId),className:"sc-button style-place-bid style fl-button pri-3 mt-5",style:{width:"220px"},children:s.jsx("span",{children:"Chỉnh sửa bài nộp"})})]})]}),s.jsx("div",{onClick:()=>D(t==null?void 0:t.status,t==null?void 0:t.contestId),className:"card-title",children:s.jsx("h5",{children:s.jsx("div",{className:"cursor-pointer",children:t==null?void 0:t.name})})}),s.jsxs("div",{className:"meta-info",style:{display:"flex",flexDirection:"row",justifyContent:"space-around !important",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Người vẽ"}),s.jsx("h6",{children:s.jsx("div",{className:"cursor-none",children:t==null?void 0:t.ownerName})})]})}),s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Cấp"}),s.jsx("h6",{children:s.jsx("div",{className:"cursor-none",children:t==null?void 0:t.level})})]})})]}),s.jsxs("div",{children:[s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Cuộc thi"}),s.jsx("h6",{children:s.jsx("div",{className:"cursor-none",children:t==null?void 0:t.contestName})})]})}),s.jsx("div",{className:"author",children:s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Thời gian nộp"}),s.jsx("h6",{children:s.jsx("div",{className:"price-details",children:Ps(t==null?void 0:t.submitTime)})})]})})})]})]}),s.jsxs("div",{className:"card-bottom style-explode justify-content-around",children:[s.jsxs("div",{className:"price w-50",children:[s.jsx("span",{children:"Tên chủ đề"}),s.jsx("div",{className:"price-details",children:s.jsx("h5",{children:t.topicName})})]}),s.jsxs("div",{className:"price w-50",children:[s.jsx("span",{children:"Mô tả"}),s.jsx("div",{className:"price-details",children:s.jsx("h5",{children:t==null?void 0:t.description})})]})]})]},v)):s.jsx(_s,{ml:16,children:s.jsx("h2",{className:"centered-message-container",children:"Bạn chưa có tranh nào!"})})}),r<e.length&&s.jsx("div",{className:"btn-auction center",children:s.jsx(R,{to:"#",id:"load-more",className:"sc-button loadmore fl-button pri-3",onClick:w,children:s.jsx("span",{children:"Xem thêm"})})})]}),s.jsx(Qs,{paintingId:g,show:p,onHide:()=>u(!1)}),s.jsx(Zs,{showReject:m,onHide:()=>b(!1)})]})})},Ys=()=>s.jsx("div",{className:"explore",children:s.jsx("div",{className:"box-epxlore justify-content-start",children:Array(3).fill().map((i,e)=>s.jsxs("div",{className:"sc-card-product explode style2 mg-bt",children:[s.jsx("div",{className:"card-media",children:s.jsx(E,{width:"290px",height:"290px",radius:"16px"})}),s.jsx("div",{className:"card-title",children:s.jsx(E,{width:"100%",height:"30px",radius:"16px"})}),s.jsxs("div",{className:"meta-info",children:[s.jsxs("div",{className:"author",children:[s.jsx("div",{className:"avatar",children:s.jsx(E,{width:"40px",height:"40px",radius:"16px"})}),s.jsx("div",{className:"info",children:s.jsx(E,{width:"120px",height:"40px",radius:"16px"})})]}),s.jsx("div",{className:"tag",children:s.jsx(E,{width:"50px",height:"40px",radius:"16px"})})]}),s.jsx("div",{className:"card-bottom style-explode",children:s.jsx("div",{className:"price",children:s.jsx(E,{width:"132px",height:"45px",radius:"16px"})})})]},e))})}),Zs=({showReject:i,onHide:e})=>s.jsxs(L,{animation:!0,scrollable:!0,show:i,onHide:e,centered:!0,children:[s.jsx(L.Header,{closeButton:!0}),s.jsx(L.Body,{children:s.jsx("div",{className:"space-y-20 pd-40",children:s.jsx("h4",{className:"text-center font-weight-bold",children:"Tranh của bạn không thể chỉnh sửa sau khi nộp"})})})]}),zs=i=>{var b,g;const e=i.data,{userInfo:n}=ls(h=>h.auth),{isLoading:r,isError:d,data:p,error:u}=cs("paintings/listpaintingbyaccountid",`${n.Id}`),m=(g=(b=p==null?void 0:p.data)==null?void 0:b.result)==null?void 0:g.list;return d?s.jsxs("span",{children:["Error: ",u.message]}):s.jsx("section",{className:"tf-explore tf-section",children:s.jsx("div",{className:"themesflat-container",children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-xl-3 col-lg-3 col-md-12",children:s.jsx("div",{id:"side-bar",className:"side-bar style-3",children:(m==null?void 0:m.length)>0?e.map((h,j)=>s.jsx("div",{className:"widget widget-category mgbt-24 boder-bt",children:s.jsx("div",{className:"content-wg-category",children:s.jsx(Hs,{title:h.title,show:!0,children:s.jsx("form",{action:"#",children:h.content.map((w,O)=>s.jsxs("div",{children:[s.jsxs("label",{children:[w.field,s.jsx("input",{type:"checkbox",defaultChecked:w.checked}),s.jsx("span",{className:"btn-checkbox"})]}),s.jsx("br",{})]},O))})})})},j)):null})}),s.jsx("div",{className:"col-xl-9 col-lg-9 col-md-12",children:s.jsx(Xs,{data:m,loading:r})})]})})})},Js=[{id:1,title:"Collections",content:[{field:"Abstraction"},{field:"Patternlicious"},{field:"Skecthify"},{field:"Cartoonism"},{field:"Virtuland"},{field:"Papercut"}]}],xe=()=>s.jsxs("div",{children:[s.jsx(Vs,{}),s.jsxs("section",{className:"flat-title-page inner",children:[s.jsx("div",{className:"overlay"}),s.jsx("div",{className:"themesflat-container",children:s.jsx("div",{className:"row",children:s.jsxs("div",{className:"col-md-12",children:[s.jsx("div",{className:"page-title-heading mg-bt-12",children:s.jsx("h1",{className:"heading text-center",children:"Tranh Của Tôi"})}),s.jsx("div",{className:"breadcrumbs style2",children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx(R,{to:"/",children:"Trang chủ"})}),s.jsx("li",{children:"Tranh của tôi"})]})})]})})})]}),s.jsx(zs,{data:Js}),s.jsx(Fs,{})]});export{xe as default};
