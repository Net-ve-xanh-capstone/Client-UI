var V=(n,e,i)=>{if(!e.has(n))throw TypeError("Cannot "+i)};var c=(n,e,i)=>(V(n,e,"read from private field"),i?i.call(n):e.get(n)),y=(n,e,i)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,i)},w=(n,e,i,r)=>(V(n,e,"write to private field"),r?r.call(n,i):e.set(n,i),i);var T=(n,e,i)=>(V(n,e,"access private method"),i);import{aS as vs,aT as gs,aU as $,aV as Ns,aW as z,aX as J,r as d,aY as fs,aZ as Cs,n as ys,m as ss,a_ as Ss,u as es,j as s,a$ as G,L as b,T as ws,Y as W,b0 as Ts,G as Is,c as I,e as Es}from"./index-DiIdva_9.js";import{H as Ms}from"./HeaderVersion1-CLId0ABN.js";import{A as Os}from"./index-uvbC9cbD.js";import{T as Ls,a as ks,b as Y,c as Q}from"./TabPanel-BzkRbvxp.js";/* empty css                   */import{D as O}from"./index-yCy8Ynvi.js";import{a as Ds}from"./TextareaCommon-DkUvbFHn.js";import{c as Ps,a as _s,o as As}from"./object-DB-QGBsw.js";var N,f,m,g,E,A,L,U,Z,Fs=(Z=class extends vs{constructor(e,i){super();y(this,E);y(this,L);y(this,N,void 0);y(this,f,void 0);y(this,m,void 0);y(this,g,void 0);w(this,N,e),this.setOptions(i),this.bindMethods(),T(this,E,A).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var r;const i=this.options;this.options=c(this,N).defaultMutationOptions(e),gs(this.options,i)||c(this,N).getMutationCache().notify({type:"observerOptionsUpdated",mutation:c(this,m),observer:this}),i!=null&&i.mutationKey&&this.options.mutationKey&&$(i.mutationKey)!==$(this.options.mutationKey)?this.reset():((r=c(this,m))==null?void 0:r.state.status)==="pending"&&c(this,m).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=c(this,m))==null||e.removeObserver(this)}onMutationUpdate(e){T(this,E,A).call(this),T(this,L,U).call(this,e)}getCurrentResult(){return c(this,f)}reset(){var e;(e=c(this,m))==null||e.removeObserver(this),w(this,m,void 0),T(this,E,A).call(this),T(this,L,U).call(this)}mutate(e,i){var r;return w(this,g,i),(r=c(this,m))==null||r.removeObserver(this),w(this,m,c(this,N).getMutationCache().build(c(this,N),this.options)),c(this,m).addObserver(this),c(this,m).execute(e)}},N=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,E=new WeakSet,A=function(){var i;const e=((i=c(this,m))==null?void 0:i.state)??Ns();w(this,f,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},L=new WeakSet,U=function(e){z.batch(()=>{var i,r,h,j,u,x,p,v;if(c(this,g)&&this.hasListeners()){const l=c(this,f).variables,t=c(this,f).context;(e==null?void 0:e.type)==="success"?((r=(i=c(this,g)).onSuccess)==null||r.call(i,e.data,l,t),(j=(h=c(this,g)).onSettled)==null||j.call(h,e.data,null,l,t)):(e==null?void 0:e.type)==="error"&&((x=(u=c(this,g)).onError)==null||x.call(u,e.error,l,t),(v=(p=c(this,g)).onSettled)==null||v.call(p,void 0,e.error,l,t))}this.listeners.forEach(l=>{l(c(this,f))})})},Z);function Hs(n,e){const i=J(),[r]=d.useState(()=>new Fs(i,n));d.useEffect(()=>{r.setOptions(n)},[r,n]);const h=d.useSyncExternalStore(d.useCallback(u=>r.subscribe(z.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),j=d.useCallback((u,x)=>{r.mutate(u,x).catch(fs)},[r]);if(h.error&&Cs(r.options.throwOnError,[h.error]))throw h.error;return{...h,mutate:j,mutateAsync:h.mutate}}const X="collections/getcollectionbyaccountid",Vs="collections",Us="paintingcollections/addpaintingtocollection",Ks=n=>{var R;const e=Ps().shape({collection:_s().required("Vui lòng chọn bộ sưu tập")}),{watch:i,formState:{errors:r},setValue:h,setError:j,control:u,reset:x,handleSubmit:p}=ys({resolver:As(e),reValidateMode:"onChange"}),[v,l]=d.useState(0),[t,S]=d.useState([]),[M,k]=d.useState([]),[ts,Gs]=d.useState(!1),[as,K]=d.useState(""),[D,P]=d.useState(""),[is,F]=d.useState(""),ns=J(),H=ss(a=>a.auth.userInfo),q=n.paintingId,rs=(a,o="")=>i(a)||o,cs=(a,o)=>{h(a,o.name),K(o.id),j(a,"")},B=(a,o,C)=>Hs({mutationFn:a,onSuccess:()=>{ns.invalidateQueries([X,H.Id]),P(o)},onError:()=>{P(C)}}),ls=B(a=>W.create(Vs,a),"Tạo bộ sưu tập thành công","Tạo bộ sưu tập thất bại"),os=B(a=>W.create(Us,a),"Thêm vào bộ sưu tập thành công","Thêm vào bộ sưu tập thất bại"),ds=a=>{const o={name:a.name,description:a.description,currentUserId:H.Id,listPaintingId:[q]};ls.mutate(o)},hs=()=>{const a={collectionId:as,paintingId:q};os.mutate(a)},us=async a=>{if(!t)return;const o=t.filter(C=>C.name.toLowerCase().includes(a.toLowerCase()));k(o)},xs=d.useCallback(Ss.debounce(a=>us(a),500),[t]),ms=a=>{const o=a.target.value;F(o),xs(o)},js=()=>{n.onHide(),x(),P(""),F(""),k(t)},ps=a=>{l(a),x(),P(""),F(""),k(t),K("")},{isLoading:bs,isError:Ws,data:_,error:Ys}=es(X,H.Id);return d.useEffect(()=>{var o,C;const a=(o=_==null?void 0:_.data)==null?void 0:o.result;((C=a==null?void 0:a.list)==null?void 0:C.length)>0?(l(0),S(a==null?void 0:a.list),k(a==null?void 0:a.list)):l(1)},[_,ts]),bs?s.jsx("div",{children:"Loading"}):s.jsxs(G,{animation:!0,scrollable:!0,show:n.show,onHide:js,children:[s.jsx(G.Header,{closeButton:!0}),s.jsx("div",{className:"modal-body space-y-20 pd-40",style:{height:"500px"},children:s.jsx("div",{className:"flat-tabs themesflat-tabs",children:s.jsxs(Ls,{defaultIndex:v,onSelect:ps,children:[s.jsxs(ks,{children:[s.jsx(Y,{children:"Đã có bộ sưu tập"}),s.jsx(Y,{children:"Chưa có bộ sưu tập"})]}),s.jsxs(Q,{className:"mt-5",selected:!0,allowFullScreen:!0,children:[s.jsx("div",{id:"item-create",className:"dropdown mt-5",children:M&&M.length>0?s.jsxs("div",{children:[s.jsx("h3",{className:"mb-5",children:"Thêm vào bộ sưu tập"}),r.collection&&s.jsx("span",{className:"text-danger h5",children:r.collection.message}),s.jsxs(O,{children:[s.jsx(O.Select,{placeholder:rs("collection","Chọn collection của bạn")}),s.jsxs(O.List,{children:[s.jsx(O.Search,{defaultValue:is,onChange:ms}),M.map((a,o)=>s.jsx(O.Option,{onClick:()=>cs("collection",a),children:a==null?void 0:a.name},o))]})]}),s.jsx(b,{to:"#",onClick:p(hs),className:"btn btn-primary mt-4","data-toggle":"modal","data-target":"#popup_bid_success","data-dismiss":"modal","aria-label":"Close",children:"Thêm"}),D&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("p",{style:{color:"#000000",fontWeight:"bold"},children:D})})]}):s.jsxs("div",{children:[s.jsx("h3",{children:"Bạn chưa có bộ sưu tập nào"}),s.jsx("div",{id:"item-create",className:"dropdown mt-5",children:s.jsx("h4",{className:"text-center",children:"Hãy tạo bộ sưu tập mới"})})]})}),s.jsx("div",{className:"hr"})]}),s.jsxs(Q,{className:"mt-5",allowFullScreen:!0,children:[s.jsx("h3",{className:"mb-15",children:"Tạo bộ sưu tập mới"}),s.jsx(ws,{control:u,error:(R=r.name)==null?void 0:R.message,id:"name",name:"name",tabIndex:"1",placeholder:"Nhập tên của bức tranh",className:"mb-15",autoFocus:!0}),s.jsx("div",{className:"hr"}),s.jsx(Ds,{control:u,id:"description",name:"description",tabIndex:"1",placeholder:"Nhập mô tả của bức tranh",className:"mb-15",autoFocus:!0}),s.jsx(b,{to:"#",className:"btn btn-primary mt-4","data-toggle":"modal","data-target":"#popup_bid_success","data-dismiss":"modal",onClick:p(ds),"aria-label":"Close",children:"Thêm và tạo bộ sưu tập mới"}),D&&s.jsx("div",{className:"mt-4 text-center",children:s.jsx("p",{style:{color:"#000000",fontWeight:"bold"},children:D})})]})]})})})]})},qs=n=>{const e=n.data,i=n.loading,[r,h]=d.useState(6),[j,u]=d.useState(!1),[x,p]=d.useState(null),v=()=>{h(t=>t+6)},l=t=>{p(t),u(!0)};return s.jsx(d.Fragment,{children:i?s.jsx(Bs,{}):s.jsxs("div",{children:[s.jsxs("div",{className:"explore",children:[s.jsx("div",{className:"box-epxlore justify-content-start",children:e.length>0?e.slice(0,r).map((t,S)=>s.jsxs("div",{className:`sc-card-product mr-4 explode style2 mg-bt ${t.feature?"comingsoon":""} `,children:[s.jsxs("div",{className:"card-media",children:[s.jsx(b,{onClick:()=>l(t.id),children:s.jsx("img",{src:t==null?void 0:t.image,alt:"tranh"})}),s.jsx("div",{className:"button-place-bid",children:s.jsx("button",{onClick:()=>l(t.id),className:"sc-button style-place-bid style fl-button pri-3",children:s.jsx("span",{children:"Thêm vào bộ sưu tập"})})})]}),s.jsx("div",{className:"card-title",children:s.jsx("h5",{children:s.jsx(b,{className:"cursor-none",to:"#",children:t==null?void 0:t.name})})}),s.jsxs("div",{className:"meta-info",style:{display:"flex",flexDirection:"row",justifyContent:"space-around !important",alignItems:"center"},children:[s.jsxs("div",{children:[s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Người vẽ"}),s.jsx("h6",{children:s.jsx(b,{className:"cursor-none",children:t==null?void 0:t.ownerName})})]})}),s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Cấp"}),s.jsx("h6",{children:s.jsx(b,{className:"cursor-none",children:t==null?void 0:t.level})})]})})]}),s.jsxs("div",{children:[s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Cuộc thi"}),s.jsx("h6",{children:s.jsx(b,{className:"cursor-none",children:t==null?void 0:t.contestName})})]})}),s.jsx("div",{className:"author",children:s.jsx("div",{className:"author",children:s.jsxs("div",{className:"info",children:[s.jsx("span",{children:"Thời gian nộp"}),s.jsx("h6",{children:s.jsx(b,{className:"cursor-none",children:Ts(t==null?void 0:t.submitTime)})})]})})})]})]}),s.jsxs("div",{className:"card-bottom style-explode",children:[s.jsxs("div",{className:"price",children:[s.jsx("span",{children:"Tên chủ đề"}),s.jsx("div",{className:"price-details",children:s.jsx("h5",{children:t.topicName})})]}),s.jsxs("div",{className:"price",children:[s.jsx("span",{children:"Mô tả"}),s.jsx("div",{className:"price-details",children:s.jsx("h5",{children:t==null?void 0:t.description})})]})]})]},S)):s.jsx(Is,{ml:16,children:s.jsx("h2",{className:"centered-message-container",children:"Bạn chưa có tranh nào!"})})}),r<e.length&&s.jsx("div",{className:"btn-auction center",children:s.jsx(b,{to:"#",id:"load-more",className:"sc-button loadmore fl-button pri-3",onClick:v,children:s.jsx("span",{children:"Load More"})})})]}),s.jsx(Ks,{paintingId:x,show:j,onHide:()=>u(!1)})]})})},Bs=()=>s.jsx("div",{className:"explore",children:s.jsx("div",{className:"box-epxlore justify-content-start",children:Array(3).fill().map((n,e)=>s.jsxs("div",{className:"sc-card-product explode style2 mg-bt",children:[s.jsx("div",{className:"card-media",children:s.jsx(I,{width:"290px",height:"290px",radius:"16px"})}),s.jsx("div",{className:"card-title",children:s.jsx(I,{width:"100%",height:"30px",radius:"16px"})}),s.jsxs("div",{className:"meta-info",children:[s.jsxs("div",{className:"author",children:[s.jsx("div",{className:"avatar",children:s.jsx(I,{width:"40px",height:"40px",radius:"16px"})}),s.jsx("div",{className:"info",children:s.jsx(I,{width:"120px",height:"40px",radius:"16px"})})]}),s.jsx("div",{className:"tag",children:s.jsx(I,{width:"50px",height:"40px",radius:"16px"})})]}),s.jsx("div",{className:"card-bottom style-explode",children:s.jsx("div",{className:"price",children:s.jsx(I,{width:"132px",height:"45px",radius:"16px"})})})]},e))})}),Rs=n=>{var p,v;const e=n.data,{userInfo:i}=ss(l=>l.auth),{isLoading:r,isError:h,data:j,error:u}=es("paintings/listpaintingbyaccountid",`${i.Id}`),x=(v=(p=j==null?void 0:j.data)==null?void 0:p.result)==null?void 0:v.list;return h?s.jsxs("span",{children:["Error: ",u.message]}):s.jsx("section",{className:"tf-explore tf-section",children:s.jsx("div",{className:"themesflat-container",children:s.jsxs("div",{className:"row",children:[s.jsx("div",{className:"col-xl-3 col-lg-3 col-md-12",children:s.jsx("div",{id:"side-bar",className:"side-bar style-3",children:(x==null?void 0:x.length)>0?e.map((l,t)=>s.jsx("div",{className:"widget widget-category mgbt-24 boder-bt",children:s.jsx("div",{className:"content-wg-category",children:s.jsx(Os,{title:l.title,show:!0,children:s.jsx("form",{action:"#",children:l.content.map((S,M)=>s.jsxs("div",{children:[s.jsxs("label",{children:[S.field,s.jsx("input",{type:"checkbox",defaultChecked:S.checked}),s.jsx("span",{className:"btn-checkbox"})]}),s.jsx("br",{})]},M))})})})},t)):null})}),s.jsx("div",{className:"col-xl-9 col-lg-9 col-md-12",children:s.jsx(qs,{data:x,loading:r})})]})})})},$s=[{id:1,title:"Collections",content:[{field:"Abstraction"},{field:"Patternlicious"},{field:"Skecthify"},{field:"Cartoonism"},{field:"Virtuland"},{field:"Papercut"}]}],ie=()=>s.jsxs("div",{children:[s.jsx(Ms,{}),s.jsxs("section",{className:"flat-title-page inner",children:[s.jsx("div",{className:"overlay"}),s.jsx("div",{className:"themesflat-container",children:s.jsx("div",{className:"row",children:s.jsxs("div",{className:"col-md-12",children:[s.jsx("div",{className:"page-title-heading mg-bt-12",children:s.jsx("h1",{className:"heading text-center",children:"Tranh Của Tôi"})}),s.jsx("div",{className:"breadcrumbs style2",children:s.jsxs("ul",{children:[s.jsx("li",{children:s.jsx(b,{to:"/",children:"Trang chủ"})}),s.jsx("li",{children:"Tranh của tôi"})]})})]})})})]}),s.jsx(Rs,{data:$s}),s.jsx(Es,{})]});export{ie as default};
